<!DOCTYPE html>
<html lang="en">
  <head>
    <link href="./../index.css" rel="stylesheet" />

    <!-- jquery -->
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"> </script>   

       <!-- QRCode -->
       <script src="https://cdn.rawgit.com/davidshimjs/qrcodejs/gh-pages/qrcode.min.js"></script>


    <script type="text/javascript" src="./../StaticDB/ProductsDB.js"></script>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Product Page</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
      crossorigin="anonymous"
    />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
     integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" 
     crossorigin="anonymous"></script>


     
    <link href="./..index.css" rel="stylesheet" />

    <!-- Model viewer Script-->
    <script
      type="module"
      src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"
    ></script>

<style>
  model-viewer {
      width: 100%;
      height: 100%;
      }
</style>
  </head>
  <body>
    <script type="module">
      import { App } from "./app.js";

      document.addEventListener("DOMContentLoaded", function () {
        const app = new App();
        window.app = app;
      });
    </script>
    
    

    <div class="row main-page" style="display: flex; width: 90%; margin : auto ; ">
        <div class="row">
      <h1
      id="product-name">
      Product Name
    </h1>
        </div>
 
      <div class="row col-lg-6 col-sm-12" >
          <div  style="position: relative; height:500px;" > 
            <div
              style="position: relative; display: flex; align-items: center; justify-content: center; height:500px;"
              class="col col-lg-12"
              id="product-large-image"
            >
            
            
            </div>


         
          

          
           


            <!-- Button trigger modal -->
<button id="ar-button-desktop" type="button" class="btn" data-bs-toggle="modal" data-bs-target="#exampleModal"  style="position: absolute; bottom: 5px; right: 5px;">
 <img src="../assets/AR-logo.png" width="25px">
</button>

<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel" style="text-align: center;">Please scan with your mobile camera
        </h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div id="qrcode" style="display: flex; justify-content: center; align-items: center;">

        </div> 
      
      <script>
          
                  function generateQRCode() {
                      
                      let website = window.location.href;
                      if (website) {
                        let qrcodeContainer = document.getElementById("qrcode");
                        qrcodeContainer.innerHTML = "";
                        new QRCode(qrcodeContainer, website);
                        console.log(website)

                      // document.getElementById("qrcode-container").style.display = "block";
                      } else {
                        alert("unable to fetch the url of the page");
                      }
                    }
                  generateQRCode();
        </script>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript"> 

 
              
  var ARButton = document.getElementById('ar-button-desktop');
   
    if(screen.width > 991){
      console.log("QR");
    

    }
    else{
      console.log('ar');    
      ARButton.style.display = "none"
      console.log('ar button is hidden on screen < 911');


    }
  </script>








           
     
            
          </div>  
       



        <div  style="display:flex; justify-content: center;" class="col col col-lg-12" >
          <div class="product-image-list">

                <div class="product-image-btn" id="product-image-1" >

                </div>
                <div  class="product-image-btn"  id="product-image-2"  >
                
                </div>
                <div class="product-image-btn"  id="product-image-3" >

                </div>
                <div class="product-image-btn"  id="product-image-4" >
                
                    
                
                </div>

                <script >

                    function updateModel(modelId) {

                                document.getElementById(
                                        "product-large-image"
                                         ).innerHTML = ` <model-viewer 
                                         camera-controls alt="Model" src= "./../assets/${modelId}.glb" height="500px" width="100%" 
                                         shadow-intensity="1"
                                          ar ar-modes="webxr scene-viewer quick-look"
                                          auto-rotate
                                          camera-controls
                                         >
                                       
                                         </model-viewer/> `;
                            }
                            
                </script>
                    

                    

                
          </div>
        </div>
      </div>

      
    
      <div class="col col col-lg-6 col-sm-12">
        <div>
          <h1>About it:</h1>
          <p id="product-about"></p>
        </div>
        <div>
          <h1>Dimensions:</h1>
          <p id="product-dimensions"></p>
        </div>
        <div>
          <h1>Details:</h1>
          <p id="product-details"></p>
        </div>
<div style="display: flex; align-items: center; justify-content: center; margin-top: 1rem;">
 
  <!-- <div id="view-in-your-space" onclick="onClickfun();">
    View in your space
  </div> -->

</div>
        

        <script>
          function onClickfun() {
            console.log("onClickfun called!");
            console.log(productId);
            window.location.href = "modelrenderer/?productId=" + productId;
          }
        </script>
      </div>
    </div>

    <script>



      urlp = [];
      s = location.toString().split("?");
      s = s[1].split("&");
      for (i = 0; i < s.length; i++) {
        u = s[i].split("=");
        urlp[u[0]] = u[1];
      }
      var productId = urlp["productId"];
      var productDetails;

      products.map((product) => {
        // console.log(product)
        if (product.id == productId) {
          console.log("this is product id", product);
          productDetails = product;
        } else {
          productDetails = null;
        }
        console.log(productDetails);
        if (productDetails != null) {
       
          console.log("This is product name:",product.name)
          var path = "./../assets/" + productId + ".glb";
          console.log(path);
          document.getElementById(
            "product-large-image"
          ).innerHTML = `<model-viewer id="model-viewer-multiple" 
          // style="height:500px; width:100%;"
                    camera-controls alt="Model" src= "./../assets/${productId}.glb" height="100%" width="100%" 
                    shadow-intensity="1"
            ar ar-modes="webxr scene-viewer quick-look"
              auto-rotate
              camera-controls
               >
               
               </model-viewer/> `;



        document.getElementById(
            "product-name"
          ).innerHTML = `${product.name} `;

        //  document.getElementById(
        //     "button-ar"
        //   ).innerHTML = `<img src="../assets/AR-logo.png" height="50px" width="50px" alt="button-ar">`;


        


          document.getElementById(
            "product-about"
          ).innerHTML = `${product.about} `;
          document.getElementById(
            "product-dimensions"
          ).innerHTML = `${product.dimensions} `;
          document.getElementById(
            "product-details"
          ).innerHTML = `${product.details}`;
          document.getElementById(
            "product-image-1"
          ).innerHTML = `<img src=".${product.image[0]}" height="100px" width ="100px"/>`;

          document.getElementById(
            "product-image-2"
          ).innerHTML = `<img src=".${product.image[1]}" height="100px" width ="100px"/>`;

          document.getElementById(
            "product-image-3"
          ).innerHTML = `<img src=".${product.image[2]}" height="100px" width ="100px"/>`;

         
        

        }
      });




      var productImgOne = document.getElementById('product-image-1');
      var productImgTwo = document.getElementById('product-image-2');
      var productImgThree = document.getElementById('product-image-3');
             
     
      productImgOne.onclick = function() {
        productImgOne.style.backgroundColor = 'rgba(128, 128, 128, 0.281)'
        productImgTwo.style.backgroundColor = 'white';  
        productImgThree.style.backgroundColor = 'white';  
        updateModel(productId );
      };

      
      
      productImgTwo.onclick = function() {
        productImgTwo.style.backgroundColor = 'rgba(128, 128, 128, 0.281)'
        productImgOne.style.backgroundColor = 'white';  
        productImgThree.style.backgroundColor = 'white';  
        updateModel(productId + '_2');
      };

      
      productImgThree.onclick = function() {
        productImgThree.style.backgroundColor = 'rgba(128, 128, 128, 0.281)'
        productImgOne.style.backgroundColor = 'white';  
        productImgTwo.style.backgroundColor = 'white'; 
        updateModel(productId + '_3'); 
      };
       
    
  
      // <button slot="ar-button" id="ar-button" >
      //           <img src="../assets/AR-logo.png" height="50px" width="50px" style="position: absolute; bottom: 5px; right: 5px;" >
      //           view in your space    
      //                       </button>

    </script>

  </body>
</html>
